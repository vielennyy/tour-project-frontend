"use strict";(self.webpackChunk_cromwell_admin_panel=self.webpackChunk_cromwell_admin_panel||[]).push([[783],{96896:(e,t,n)=>{n.d(t,{Z:()=>o});var a=n(6620),r=n(52322);const o=(0,a.Z)((0,r.jsx)("path",{d:"M13 7h-2v4H7v2h4v4h2v-4h4v-2h-4V7zm-1-5C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"}),"AddCircleOutline")},86783:(e,t,n)=>{n.r(t),n.d(t,{default:()=>ae});var a=n(25047),r=n.n(a),o=n(63756),i=n(76082),c=n(96896),s=n(85219),l=n(36269),p=n(38677),d=n(31117),u=n(74020),m=n(16881),h=n(22089),f=n(79312),g=n(34252),v=n(30750),x=n(63735),b=n(87037),y=n(2784),_=n(31941),k=n(27166),T=n(82355),w=n(46043),C=n(65479),S=n(28743),A=n(17393),U=n(32548),E=n(80763),Z=n(46062),L=n.n(Z),M=n(44036),O=n.n(M),P=n(96793),R=n.n(P),I=n(9978),j=n.n(I),N=n(11173),J=n.n(N),z=n(42464),D=n.n(z),G=n(70210),B={attributes:{"data-meta":"crw-admin-style"}};B.styleTagTransform=D(),B.setAttributes=j(),B.insert=R().bind(null,"head"),B.domAPI=O(),B.insertStyleElement=J(),L()(G.Z,B);const F=G.Z&&G.Z.locals?G.Z.locals:void 0;function H(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function K(e,t,n,a,r,o,i){try{var c=e[o](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(a,r)}function Q(e){return function(){var t=this,n=arguments;return new Promise((function(a,r){var o=e.apply(t,n);function i(e){K(o,a,r,i,c,"next",e)}function c(e){K(o,a,r,i,c,"throw",e)}i(void 0)}))}}function Y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function q(){return q=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},q.apply(this,arguments)}function V(e){return V=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},V(e)}function W(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),a.forEach((function(t){Y(e,t,n[t])}))}return e}function X(e,t){return!t||"object"!==ee(t)&&"function"!=typeof t?H(e):t}function $(e,t){return $=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},$(e,t)}var ee=function(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};var te=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$(e,t)}(s,e);var t,n,a=(t=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=V(t);if(n){var r=V(this).constructor;e=Reflect.construct(a,arguments,r)}else e=a.apply(this,arguments);return X(this,e)});function s(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=a.call(this,e)).themeUpdates={},t.themeUnderUpdate={},t.pageRef=y.createRef();var n=H(t);t.checkUpdates=Q(r().mark((function e(){var t,a;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null===(t=n)||void 0===t||null===(a=t.pageRef)||void 0===a?void 0:a.current)){e.next=7;break}return e.next=4,n.getThemeList();case 4:return e.next=6,n.getThemeUpdates();case 6:requestAnimationFrame((function(){return setTimeout(n.checkUpdates,3e4)}));case 7:case"end":return e.stop()}}),e)})));var c=H(t);t.getThemeList=Q(r().mark((function e(){var t,n,a,o,s;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=(0,i.getRestApiClient)(),e.next=4,null==t?void 0:t.getCmsSettings();case 4:return n=e.sent,c.setState({cmsConfig:n}),e.next=8,null==t?void 0:t.getThemesInfo();case 8:null==(a=e.sent)||a.sort((function(e){return n&&e.name===n.themeName?-1:1})),a&&c.setState({packages:a}),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),console.error(e.t0);case 16:if(!(o=(0,i.getGraphQLClient)())){e.next=28;break}return e.prev=18,e.next=21,o.getAllEntities("Theme",o.ThemeFragment,"ThemeFragment");case 21:(s=e.sent)&&Array.isArray(s)&&c.setState({installedThemes:s}),e.next=28;break;case 25:e.prev=25,e.t1=e.catch(18),console.error(e.t1);case 28:case"end":return e.stop()}}),e,null,[[0,13],[18,25]])})));var l=H(t);t.getThemeUpdates=Q(r().mark((function e(){var t,n,a,o,c,s,p;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=!0,n=!1,a=void 0,e.prev=1,o=l.state.packages[Symbol.iterator]();case 3:if(t=(c=o.next()).done){e.next=19;break}return s=c.value,l.themeUpdates[s.name]=void 0,e.prev=6,e.next=9,(0,i.getRestApiClient)().getThemeUpdate(s.name);case 9:(p=e.sent)&&(l.themeUpdates[s.name]=p),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(6),console.error(e.t0);case 16:t=!0,e.next=3;break;case 19:e.next=25;break;case 21:e.prev=21,e.t1=e.catch(1),n=!0,a=e.t1;case 25:e.prev=25,e.prev=26,t||null==o.return||o.return();case 28:if(e.prev=28,!n){e.next=31;break}throw a;case 31:return e.finish(28);case 32:return e.finish(25);case 33:l.forceUpdate();case 34:case"end":return e.stop()}}),e,null,[[1,21,25,33],[6,13],[26,,28,32]])})));var p,d=H(t);t.handleSetActiveTheme=(p=Q(r().mark((function e(t){var n,a,c,s,l;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,i.getRestApiClient)(),d.setState({isChangingTheme:!0}),e.prev=3,e.next=6,n.changeTheme(t.name);case 6:a=e.sent,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(3),console.error(e.t0);case 12:return e.prev=12,e.next=16,n.getCmsSettings();case 16:(s=e.sent)&&d.setState({cmsConfig:s}),null===(c=d.state.packages)||void 0===c||c.sort((function(e){return s&&e.name===s.themeName?-1:1})),e.next=24;break;case 21:e.prev=21,e.t1=e.catch(12),console.error(e.t1);case 24:return e.prev=24,e.next=27,n.getThemeConfig(t.name);case 27:(l=e.sent)&&(U.h.setStateProp({prop:"activeTheme",payload:l}),(0,o.setStoreItem)("defaultPages",null==l?void 0:l.defaultPages)),e.next=34;break;case 31:e.prev=31,e.t2=e.catch(24),console.error(e.t2);case 34:a?C.A.success("Applied new theme"):C.A.error("Failed to set new theme"),d.setState({isChangingTheme:!1});case 36:case"end":return e.stop()}}),e,null,[[3,9],[12,21],[24,31]])}))),function(e){return p.apply(this,arguments)}),t.handleActivateTheme=function(e){var n=H(t);return Q(r().mark((function t(){var a,o;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.setState({isLoading:!0}),a=(0,i.getRestApiClient)(),o=!1,t.prev=3,t.next=6,null==a?void 0:a.activateTheme(e);case 6:return o=t.sent,t.next=9,n.getThemeList();case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(3),console.error(t.t0);case 14:n.setState({isLoading:!1}),o?C.A.success("Theme installed"):C.A.error("Failed to install theme");case 16:case"end":return t.stop()}}),t,null,[[3,11]])})))},t.handleShowUpdate=function(e,n,a){return function(){e&&a&&t.setState({updateModalInfo:{entity:e,update:a,info:n}})}};var u=H(t);t.startUpdate=function(){var e=Q(r().mark((function e(t){var n;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u.themeUnderUpdate[t.name]=!0,u.setState({updateModalInfo:null}),e.prev=3,e.next=6,(0,i.getRestApiClient)().updateTheme(t.name);case 6:n=e.sent,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(3),console.error(e.t0);case 12:return n&&(u.themeUpdates[t.name]=void 0),e.prev=13,e.next=16,u.getThemeList();case 16:e.next=21;break;case 18:e.prev=18,e.t1=e.catch(13),console.error(e.t1);case 21:n?C.A.success("Theme updated"):C.A.error("Failed to update theme"),u.themeUnderUpdate[t.name]=!1,u.forceUpdate(),(0,A.b)({onlyNew:!0});case 25:case"end":return e.stop()}}),e,null,[[3,9],[13,18]])})));return function(t){return e.apply(this,arguments)}}();var m=H(t);return t.handleDelete=function(){var e=Q(r().mark((function e(t){var n,a;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,(0,T.UB)({title:"Delete theme ".concat(null!==(n=t.title)&&void 0!==n?n:t.name,"?")});case 3:if(e.sent){e.next=6;break}return e.abrupt("return");case 6:return m.themeUnderUpdate[t.name]=!0,m.forceUpdate(),e.prev=9,e.next=12,(0,i.getRestApiClient)().deleteTheme(t.name);case 12:a=e.sent,e.next=18;break;case 15:e.prev=15,e.t0=e.catch(9),console.error(e.t0);case 18:return a&&(m.themeUpdates[t.name]=void 0),e.prev=19,e.next=22,m.getThemeList();case 22:e.next=27;break;case 24:e.prev=24,e.t1=e.catch(19),console.error(e.t1);case 27:a?C.A.info("Theme deleted"):C.A.error("Failed to delete theme"),m.themeUnderUpdate[t.name]=!1,m.forceUpdate();case 30:case"end":return e.stop()}}),e,null,[[9,15],[19,24]])})));return function(t){return e.apply(this,arguments)}}(),t.handleOpenMarket=function(){var e;null===(e=t.props.history)||void 0===e||e.push(S.BT.route)},t.openTheme=function(e){t.setState({openedTheme:W({},e,{image:e.image&&"data:image/png;base64,".concat(e.image),images:e.images&&e.images.map((function(e){return"data:image/png;base64,".concat(e)}))})})},t.state={isLoading:!1,isChangingTheme:!1,packages:[],installedThemes:[]},t}var l=s.prototype;return l.componentDidMount=function(){this.init()},l.init=function(){var e=this;return Q(r().mark((function t(){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({isLoading:!0}),t.next=3,e.getThemeList();case 3:return e.setState({isLoading:!1}),t.next=6,e.getThemeUpdates();case 6:setTimeout(e.checkUpdates,3e4);case 7:case"end":return t.stop()}}),t)})))()},l.render=function(){var e,t,n,a,r,o=this,i=this.state,s=i.isLoading,l=i.packages,x=i.installedThemes,b=i.cmsConfig,T=i.isChangingTheme;return y.createElement("div",{className:F.ThemeList,ref:this.pageRef},y.createElement(p.Z,{className:F.addBtn,onClick:this.handleOpenMarket,variant:"contained",color:"primary",startIcon:y.createElement(c.Z,null)},"Add themes"),s&&y.createElement("div",{className:F.list},Array(2).fill(1).map((function(e,t){return y.createElement(d.Z,{key:t,variant:"rectangular",height:"388px",width:"300px",style:{margin:"0 10px 20px 10px"}}," ")}))),!s&&y.createElement("div",{className:F.list},l.map((function(e){var t,n,a=o,r=Boolean(b&&b.themeName===e.name),i=null==x?void 0:x.find((function(t){return t.name===e.name})),c=null!==(t=null==i?void 0:i.isInstalled)&&void 0!==t&&t,s=o.themeUpdates[e.name],l=o.themeUnderUpdate[e.name];return y.createElement("div",{className:"".concat(F.themeCard," ").concat(E.Z.paper),key:e.name},y.createElement(u.Z,{className:F.cardActionArea,style:{opacity:l?.5:1}},y.createElement("div",{style:{backgroundImage:'url("data:image/png;base64,'.concat(e.image,'")')},className:F.themeImage}),y.createElement(m.Z,{className:F.mainInfo},y.createElement(h.Z,{color:"secondary",badgeContent:r?"Active":null},y.createElement(f.Z,{gutterBottom:!0,variant:"h5",component:"h2",className:F.themeTitle},e.title)),y.createElement("p",{className:F.version,onClick:o.handleShowUpdate(i,e,s),style:{cursor:s?"pointer":"initial"}},(null!==(n=null==e?void 0:e.version)&&void 0!==n?n:"")+(s?" > "+s.version+" Open info":"")),y.createElement(f.Z,{variant:"body2",color:"textSecondary",component:"p"},e.excerpt))),y.createElement(g.Z,{style:{opacity:l?.5:1},className:F.themeActions,disableSpacing:!0},!c&&y.createElement(p.Z,{disabled:l||T,size:"small",color:"primary",variant:"contained",onClick:o.handleActivateTheme(e.name)},"Install theme"),c&&r&&y.createElement(p.Z,{disabled:l||T,size:"small",color:"primary",variant:"contained",onClick:function(){var e="".concat(S.Hg.baseRoute);a.props.history.push(e)}},"Edit theme"),s&&y.createElement(p.Z,{disabled:l||T,size:"small",color:"primary",variant:"contained",onClick:function(){return a.startUpdate(e)}},"Update"),c&&!r&&y.createElement(p.Z,{size:"small",color:"primary",variant:"contained",onClick:function(){return a.handleSetActiveTheme(e)},disabled:l||T},"Set active"),y.createElement(p.Z,{size:"small",color:"primary",variant:"outlined",disabled:l||T,onClick:function(){return a.handleDelete(e)}},"Delete"),y.createElement(p.Z,{size:"small",color:"primary",variant:"outlined",onClick:function(){return a.openTheme(e)}},"Info"),l&&y.createElement(v.Z,{className:F.updateProgress})))}))),y.createElement(_.Q,{isActive:T}),y.createElement(w.Z,{open:!!this.state.updateModalInfo,onClose:function(){return o.setState({updateModalInfo:null})},className:E.Z.center,blurSelector:"#root"},y.createElement(ne,q({underUpdate:this.themeUnderUpdate},null!==(a=null===(e=this.state)||void 0===e?void 0:e.updateModalInfo)&&void 0!==a?a:{},{onStartUpdate:this.startUpdate,onClose:function(){return o.setState({updateModalInfo:null})}}))),y.createElement(w.Z,{open:!!this.state.openedTheme,blurSelector:"#root",className:E.Z.center,onClose:function(){return o.setState({openedTheme:void 0})}},(null===(t=this.state)||void 0===t?void 0:t.openedTheme)&&y.createElement(k.Z,{installedModules:null!==(r=null===(n=this.state)||void 0===n?void 0:n.installedThemes)&&void 0!==r?r:[],data:this.state.openedTheme,noInstall:!0})))},s}(y.Component),ne=function(e){var t,n=e.update,a=e.entity,r=e.info,o=(null==a?void 0:a.name)&&e.underUpdate[a.name];return y.createElement(x.ZP,{item:!0,container:!0,xs:12,className:F.updateModal},y.createElement(x.ZP,{item:!0,className:F.updateHeader},y.createElement("h3",{className:F.updateTitle},y.createElement(s.Z,{style:{marginRight:"7px"}}),"Update available"),y.createElement(b.Z,{style:{marginRight:"-10px"},onClick:e.onClose},y.createElement(l.Z,null))),y.createElement("p",null,null!==(t=null==r?void 0:r.version)&&void 0!==t?t:""," ",">"," ",n.version),y.createElement("div",{className:F.changelogList,dangerouslySetInnerHTML:{__html:n.changelog}}),y.createElement(p.Z,{disabled:o,color:"primary",variant:"contained",onClick:function(){return e.onStartUpdate(r)}},"Update"))};const ae=te},70210:(e,t,n)=>{n.d(t,{Z:()=>c});var a=n(8081),r=n.n(a),o=n(23645),i=n.n(o)()(r());i.push([e.id,'.text_jy2Dg{font-family:"Roboto","sans-serif"}.center_Uur2r{display:flex;align-items:center;justify-content:center}.paper_soc7L{box-shadow:0 2px 3px 0 rgba(0,0,0,.05),0 0 11px 5px rgba(0,0,0,.05);background-color:#fff;border-radius:5px}.page_SGWfR{display:flex;flex-direction:column;height:100%}.pageHeader_SS69c{display:inline-block}.pageContent_ODQKv{display:inline-block;height:100%;overflow:auto}.pageTitle_SwnJM{display:flex;align-items:center;font-weight:500}.pageTitle_SwnJM::before{content:"";width:5px;height:5px;background-color:#333;margin-right:8px;display:block;border-radius:100%}.modeDark .pageTitle_SwnJM::before{background-color:#eee}.ThemeList_JJA9Y{padding:20px;max-width:1200px;margin:0 auto;width:100%;height:fit-content}.ThemeList_JJA9Y .addBtn_szBcJ{margin-bottom:15px}.list_yYC2A{display:flex;flex-wrap:wrap;width:100%}.themeCard_F2gdJ{width:300px;margin:0 20px 20px 0;background-color:#fff}.themeCard_F2gdJ .cardActionArea_phsd_{padding:10px}.themeCard_F2gdJ div.mainInfo_iiZ1G{margin-top:20px;padding:0}.themeImage_q2ean{background-position:center;background-repeat:no-repeat;background-size:contain;width:100%;height:200px}div.themeActions_ivzrG{position:relative;display:flex;flex-wrap:wrap;padding-bottom:10px}div.themeActions_ivzrG>button{margin-top:10px;margin-right:10px}h2.themeTitle_RIodT{margin-right:15px;margin-bottom:0}.version_Nv8nZ{font-size:12px;color:#666;margin-bottom:10px}.ThemeList_JJA9Y .updateProgress_wJV_P{position:absolute;bottom:0;left:0;right:0;width:100%;height:3px}.updateModal_o8GMP{display:flex;flex-direction:column;min-width:300px;max-width:90vw;max-height:90vh;overflow:auto;padding:5px 15px 15px 15px;box-shadow:0 2px 3px 0 rgba(0,0,0,.05),0 0 11px 5px rgba(0,0,0,.05);background-color:#fff;border-radius:5px}.updateModal_o8GMP>p{margin:6px 0 5px 0;font-size:13px}.updateHeader_kdj8f{display:flex;justify-content:space-between;align-items:center}.updateTitle_C5qUQ{display:flex;align-items:center}.expand_GX83H{transform:rotate(0deg);margin-left:auto;transition:.3s}.expandOpen_krMEB{transform:rotate(180deg)}.changelogTitle_xeuRj{display:flex;align-items:center;margin-bottom:10px}.changelogTitle_xeuRj>p{cursor:pointer;font-size:13px}.changelogTitle_xeuRj>svg{cursor:pointer;margin-left:5px}.changelogList_K2Lh0{margin:10px 0;padding-bottom:10px}.changelogList_K2Lh0 p{font-weight:500;margin-bottom:6px}.changelogList_K2Lh0 br{content:" ";width:100%;height:1px;display:block;border-bottom:1px solid #ccc;margin:10px 0}.changelogList_K2Lh0 li{margin-bottom:6px;font-size:13px}.modeDark .updateModal_o8GMP,.modeDark .themeCard_F2gdJ{background-color:#333}.modeDark .updateModal_o8GMP *,.modeDark .themeCard_F2gdJ *{color:#eee}',""]),i.locals={text:"text_jy2Dg",center:"center_Uur2r",paper:"paper_soc7L",page:"page_SGWfR",pageHeader:"pageHeader_SS69c",pageContent:"pageContent_ODQKv",pageTitle:"pageTitle_SwnJM",ThemeList:"ThemeList_JJA9Y",addBtn:"addBtn_szBcJ",list:"list_yYC2A",themeCard:"themeCard_F2gdJ",cardActionArea:"cardActionArea_phsd_",mainInfo:"mainInfo_iiZ1G",themeImage:"themeImage_q2ean",themeActions:"themeActions_ivzrG",themeTitle:"themeTitle_RIodT",version:"version_Nv8nZ",updateProgress:"updateProgress_wJV_P",updateModal:"updateModal_o8GMP",updateHeader:"updateHeader_kdj8f",updateTitle:"updateTitle_C5qUQ",expand:"expand_GX83H",expandOpen:"expandOpen_krMEB",changelogTitle:"changelogTitle_xeuRj",changelogList:"changelogList_K2Lh0"};const c=i}}]);